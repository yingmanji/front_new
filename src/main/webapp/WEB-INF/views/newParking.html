<!DOCTYPE html>
<html>
<meta charset="utf-8">
<head>
    <title>创建新的停车场</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Fonts -->
    <link href='http://fonts.googleapis.com/css?family=Roboto+Condensed:300,400' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Lato:300,400,700,900' rel='stylesheet' type='text/css'>
    <!-- CSS Libs -->
    <link rel="stylesheet" type="text/css" href="/resource/lib/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="/resource/lib/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="/resource/lib/css/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/resource/lib/css/bootstrap-switch.min.css">
    <link rel="stylesheet" type="text/css" href="/resource/lib/css/checkbox3.min.css">
    <link rel="stylesheet" type="text/css" href="/resource/lib/css/jquery.dataTables.min.css">
    <link rel="stylesheet" type="text/css" href="/resource/lib/css/dataTables.bootstrap.css">
    <link rel="stylesheet" type="text/css" href="/resource/lib/css/select2.min.css">
    <!-- CSS App -->
    <link rel="stylesheet" type="text/css" href="/resource/css/style.css">
    <link rel="stylesheet" type="text/css" href="/resource/css/themes/flat-blue.css">

    <link href="/resource/lib/css/gsdk-bootstrap-wizard.css" rel="stylesheet" />
    <link href="/resource/lib/css/demo.css" rel="stylesheet" />

    <script type="text/javascript" src="http://api.map.baidu.com/api?v=1.3"></script>

</head>

<body class="flat-blue">
<div class="app-container">
    <div class="row content-container">
        <nav class="navbar navbar-default navbar-fixed-top navbar-top">
            <div class="container-fluid">
                <div class="navbar-header">
                    <button type="button" class="navbar-expand-toggle">
                        <i class="fa fa-bars icon"></i>
                    </button>
                    <ol class="breadcrumb navbar-breadcrumb">
                        <li class="active">后台管理</li>
                    </ol>
                    <button type="button" class="navbar-right-expand-toggle pull-right visible-xs">
                        <i class="fa fa-th icon"></i>
                    </button>
                </div>

                <div>
                    <ul class="nav navbar-nav navbar-right">
                        <li class="dropdown profile">
                            <a id="tabName" href="" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">你的用户名 <span class="caret"></span></a>
                            <ul class="dropdown-menu animated fadeInDown">
                                <li class="profile-img">
                                    <img src="/resource/img/profile/picjumbo.com_HNCK4153_resize.jpg" class="profile-img">
                                </li>
                                <li>
                                    <div class="profile-info">
                                        <h4 class="username" id="tabAdminName">你的用户名</h4>
                                        <div class="btn-group margin-bottom-2x"> <!-- role="group"-->
                                            <!--<button type="button" class="btn btn-default"><i class="fa fa-user"></i> 我的</button>-->
                                            <button type="button" class="btn btn-default" onclick="delCookie()"><i class="fa fa-sign-out"></i> 退出</button>
                                        </div>
                                    </div>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
        <div class="side-menu sidebar-inverse">
            <nav class="navbar navbar-default" role="navigation">
                <div class="side-menu-container">
                    <div class="navbar-header">
                        <div class="navbar-brand">
                            <div class="icon fa fa-paper-plane"></div>
                            <div class="title">欢迎使用本平台</div>
                        </div>
                        <button type="button" class="navbar-expand-toggle pull-right visible-xs">
                            <i class="fa fa-times icon"></i>
                        </button>
                    </div>
                    <ul class="nav navbar-nav">
                        <li>
                            <a href="/toIndex">
                                <span class="icon fa fa-tachometer"></span><span class="title">主页</span>
                            </a>
                        </li>


                        <li class="panel panel-default dropdown">
                            <a data-toggle="collapse" href="#dropdown-user">
                                <span class="icon fa fa-desktop"></span><span class="title">用户管理</span>
                            </a>
                            <!-- Dropdown level 1 -->
                            <div id="dropdown-user" class="panel-collapse collapse">
                                <div class="panel-body">
                                    <ul class="nav navbar-nav">
                                        <li><a href="/toUser">普通用户管理</a>
                                        </li>
                                        <li><a href="/toParkmanager">停车场管理员管理</a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </li>

                        <li class="panel panel-default dropdown">
                            <a data-toggle="collapse" href="#dropdown-order">
                                <span class="icon fa fa-file-text-o"></span><span class="title">订单管理</span>
                            </a>
                            <!-- Dropdown level 1 -->
                            <div id="dropdown-order" class="panel-collapse collapse">
                                <div class="panel-body">
                                    <ul class="nav navbar-nav">
                                        <li><a href="/toOrders">已完成订单</a>
                                        </li>
                                        <li><a href="/toGenerate">可共享车位</a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </li>

                        <li class="panel panel-default dropdown active">
                            <a data-toggle="collapse" href="#dropdown-parking">
                                <span class="icon fa fa-archive"></span><span class="title">停车场管理</span>
                            </a>
                            <!-- Dropdown level 1 -->
                            <div id="dropdown-parking" class="panel-collapse collapse">
                                <div class="panel-body">
                                    <ul class="nav navbar-nav">
                                        <li><a href="/toParking">查看停车场</a>
                                        </li>
                                        <li><a href="/toNewParking">新增停车场</a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </li>

                        <li>
                            <a href="/toParkinglot">
                                <span class="icon fa fa-table"></span><span class="title">查看车位</span>
                            </a>
                        </li>
                        <li>
                            <a href="/toLicense">
                                <span class="icon fa fa-thumbs-o-up"></span><span class="title">关于</span>
                            </a>
                        </li>
                    </ul>
                </div>
                <!-- /.navbar-collapse -->
            </nav>
        </div>
        <div class="container-fluid">
            <div class="padding-top">
                <div class="row">
                    <div class="wizard-container col-sm-8 col-sm-offset-2">
                        <div class="card wizard-card" data-color="azzure" id="wizardProfile">
                            <form id="setPAAForm" >
                                <div class="wizard-header">
                                    <h3>
                                        <b>加入</b>我们的共享世界<br>
                                        <small>这里有你想要的，有你想不到的！</small>
                                    </h3>
                                </div>
                                <div class="wizard-navigation">
                                    <ul>
                                        <li><a href="#parking" data-toggle="tab">停车场信息</a></li>
                                        <li><a href="#parkingAdmin" data-toggle="tab" onclick="a()">合作账号</a></li>
                                    </ul>
                                </div>
                                <div class="tab-content">
                                    <div class="tab-pane" id="parking">
                                        <div class="row">
                                            <h4 class="info-text">首先，我们先对您加入我们的停车场的信息进行录入</h4>
                                            <div class="col-sm-4 col-sm-offset-1">
                                                <div class="picture-container">
                                                    <a onclick="searchByStationName();">
                                                        <span class="glyphicon glyphicon-map-marker" style="font-size: 72px;"></span>
                                                        <h6>点击我获取经纬度</h6>
                                                    </a>
                                                </div>
                                            </div>
                                            <div class="col-sm-6">
                                                <div class="form-group">
                                                    <label>经度</label>
                                                    <input name="longitude" type="text" class="form-control" value="117.240000000" disabled>
                                                </div>
                                                <div class="form-group">
                                                    <label>纬度</label>
                                                    <input name="latitude" type="text" class="form-control" value="117.300000000" disabled>
                                                </div>
                                            </div>
                                            <div class="col-sm-10 col-sm-offset-1">
                                                <div class="form-group">
                                                    <label>停车场名称</label>
                                                    <input name="parkingName" type="text" class="form-control" placeholder="XXX停车场">
                                                </div>
                                                <div class="form-group">
                                                    <label>详细地址</label>
                                                    <input name="parkingAddress" type="text" class="form-control" placeholder="提供详细信息给路痴寻找方向">
                                                </div>
                                                <div class="form-group">
                                                    <label>备注</label>
                                                    <input name="parkingMark" type="text" class="form-control" placeholder="留下你想对他们说的话">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="tab-pane" id="parkingAdmin">
                                        <div class="row">
                                            <div class="col-sm-12">
                                                <h4 class="info-text"> 在这里，我们将给您创建一个专用账号用于管理您的停车场</h4>
                                            </div>
                                            <div class="col-sm-9 col-sm-offset-1">
                                                <div class="form-group">
                                                    <label>输入账号名</label>
                                                    <input name="adminName" type="text" class="form-control" placeholder="输入账号名作为唯一标识">
                                                </div>
                                            </div>
                                            <div class="col-sm-9 col-sm-offset-1">
                                                <div class="form-group">
                                                    <label>输入密码</label>
                                                    <input name="adminPassword1" type="text" class="form-control" placeholder="请输入密码">
                                                </div>
                                            </div>
                                            <div class="col-sm-9 col-sm-offset-1">
                                                <div class="form-group">
                                                    <label>再次输入密码</label>
                                                    <input name="adminPassword2" type="text" class="form-control" placeholder="请确认你的密码">
                                                </div>
                                            </div>
                                            <div class="col-sm-9 col-sm-offset-1">
                                                <div class="form-group" >
                                                    <label>对应的停车场</label>
                                                    <input name="parkingMessage" type="text" class="form-control" value="XXX停车场" disabled >
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="wizard-footer height-wizard">
                                    <div class="pull-right">
                                        <input type='button' class='btn btn-next btn-fill btn-info btn-wd btn-sm' name='next' value='下一步' onclick="a()" />
                                        <input type='submit' class='btn btn-finish btn-fill btn-info btn-wd btn-sm' name='finish' value='添加' disabled="disabled"/>
                                    </div>
                                    <div class="pull-left">
                                        <input type='button' class='btn btn-previous btn-fill btn-warning btn-wd btn-sm' name='previous' value='上一步' />
                                    </div>
                                    <div class="clearfix"></div>
                                </div>
                            </form>
                        </div>
                    </div>
                    <!-- wizard container -->
                </div>
            </div>
        </div>

        <!-- 模态框（Modal）-->
        <div class="modal fade" id="demoModal" tabindex="-1" role="dialog" aria-labelledby="demoModalLabel" aria-hidden="true" data-backdrop="static">
            <div class="modal-dialog" style="width: 800px;">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                        <h4 class="modal-title" id="demoModalLabel">选择停车场位置</h4>
                    </div>
                    <div class="modal-body" style="height: 500px;">
                        <div style="width:700px;margin:auto;">
                            <div id="myMap"
                                 style="position: absolute;
                                        margin-top:20px;
                                        width: 700px;
                                        height: 450px;
                                        top: 25px;
                                        border: 1px solid gray;
                                        overflow:hidden;">
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                        <button type="button" class="btn btn-warning" data-dismiss="modal" onclick="searchByStationName()">重新选择位置</button>
                        <button type="button" class="btn btn-primary" data-dismiss="modal" >确定</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
<!--   Core JS Files   -->
<script src="/resource/lib/js/jquery-2.2.4.min.js" type="text/javascript"></script>
<script src="/resource/lib/js/jquery.bootstrap.wizard.js" type="text/javascript"></script>
<script src="/resource/lib/js/gsdk-bootstrap-wizard.js"></script>
<script src="/resource/lib/js/jquery.validate.min.js"></script>

<!-- Javascript Libs -->
<!-- <script type="text/javascript" src="../lib/js/jquery.min.js"></script> -->
<script type="text/javascript" src="/resource/lib/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/resource/lib/js/Chart.min.js"></script>
<script type="text/javascript" src="/resource/lib/js/bootstrap-switch.min.js"></script>
<script type="text/javascript" src="/resource/lib/js/jquery.matchHeight-min.js"></script>
<script type="text/javascript" src="/resource/lib/js/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="/resource/lib/js/dataTables.bootstrap.min.js"></script>
<script type="text/javascript" src="/resource/lib/js/select2.full.min.js"></script>
<script type="text/javascript" src="/resource/lib/js/ace/ace.js"></script>
<script type="text/javascript" src="/resource/lib/js/ace/mode-html.js"></script>
<script type="text/javascript" src="/resource/lib/js/ace/theme-github.js"></script>
<!-- Javascript -->
<script type="text/javascript" src="/resource/js/app.js"></script>
<script type="text/javascript" src="/resource/js/index.js"></script>
<script type="text/javascript">
    var map = new BMap.Map("myMap");
    var point = new BMap.Point(113.270714,23.13552);
    map.centerAndZoom(point, 20);//数字越大初始比例越大
    map.enableScrollWheelZoom();    //启用滚轮放大缩小，默认禁用
    map.enableContinuousZoom();    //启用地图惯性拖拽，默认禁用
    map.addControl(new BMap.NavigationControl());  //添加默认缩放平移控件
    map.addControl(new BMap.OverviewMapControl()); //添加默认缩略地图控件
    map.addControl(new BMap.OverviewMapControl({ isOpen: true, anchor: BMAP_ANCHOR_BOTTOM_RIGHT }));   //右下角，打开

    var localSearch = new BMap.LocalSearch(map);
    localSearch.enableAutoViewport(); //允许自动调节窗体大小

    function searchByStationName() {
        var ad = prompt("请输入你所要添加停车场的地区","广州");
        $('#demoModal').modal('show');
        map.clearOverlays();//清空原来的标注
        var keyword = ad;
        localSearch.setSearchCompleteCallback(function (searchResult) {
            var poi = searchResult.getPoi(0);
            map.centerAndZoom(poi.point, 20);
            marker.addEventListener("click", function () { this.openInfoWindow(infoWindow); });
        });
        localSearch.search(keyword);
        map.clearOverlays();//清空原来的标
        map.addEventListener("click", function(e){

            $("input[name='longitude']").val(e.point.lng) ;
            $("input[name='latitude']").val(e.point.lat) ;
            var now_point =  new BMap.Point(e.point.lng, e.point.lat );
            marker.setPosition(now_point);//设置覆盖物位置
        });
        var marker = new BMap.Marker(point); //创建marker对象
        marker.enableDragging(); //marker可拖拽
        //拖拽结束事件
        map.addOverlay(marker); //在地图中添加marker
    }

    function a(){
        $("input[name='parkingMessage']").val($("input[name='parkingName']").val());
    }

    $('#setPAAForm').on('submit',function(){
        $.ajax({
            type:"post",
            url:"/parking/setParkingAndAdmin/",
            data: {longitude:$("input[name='longitude']").val(),
                    latitude:$("input[name='latitude']").val(),
                    parkingName:$("input[name='parkingName']").val(),
                    parkingLocation:$("input[name='parkingAddress']").val(),
                    remark:$("input[name='parkingMark']").val(),
                    adminName:$("input[name='adminName']").val(),
                    adminPassword:$("input[name='adminPassword1']").val(),
                    adminPassword2:$("input[name='adminPassword2']").val()
            },
            success: function (data) {
                alert(data);
            },
            error: function (e) {
                alert(e);
            }
        });
    })

    $("input[name='adminPassword2']").blur(
        function () {
           if($("input[name='adminPassword1']").val()==$("input[name='adminPassword2']").val()){
               $("input[name='finish']").removeAttr("disabled");
           }
           else
           {
               $("input[name='finish']").attr("disabled","true");
           }
        }
    );




</script>
</html>
